#!/usr/bin/env python
# coding: utf-8

import pandas as pd 
import requests as requests
from bs4 import BeautifulSoup


prods=("1000","10075","10080","10085","10090","10091","1010","10140","10150","10165","10170","10500","10555","10575","10620","10625","10655","10660","10665","10670","10725","10745","10755","10757","10765","10770","10890","1090","1095","10975","1098","10991","1101","1105","1107","1109","11115","11120","11121","1113","1115","11157","11160","11161","1116","1125","1127","1128","1129","1131","11325","11355","11380","11395","11410","11412","11440","11445","11447","11450","11452","1150","11720","1180","1181","1182","1183","1184","1185","11860","1186","1187","1188","1189","1190","1191","1192","1193","1194","1195","1198","1200","1201","1202","1203","1204","1205","12185","1222","12410","12425","12430","12433","12434","12435","12436","12437","12438","12439","12440","12441","12443","12445","12446","12447","12450","12465","12520","1260","1262","12680","12700","1270","12705","1272","1290","12913","12915","12920","12940","1295","12980","12985","13000","13025","13050","13060","13070","13080","13125","13160","13200","13202","13205","13206","13209","13210","13250","13262","13330","13760","13960","13975","14005","14006","14007","14085","14105","14150","14155","1420","14210","1425","14286","14300","14302","14310","14320","14380","14385","14440","14480","1450","14520","14525","14540","14580","1460","1461","14730","14732","14735","14744","14746","14748","1475","14796","14822","14834","14850","1490","14946","14947","14948","14949","14950","14951","14952","14953","14954","14955","14975","14992","15335","15336","15375","15384","15385","15386","15387","15388","15389","15395","15404","1546","1556","1565","1570","1615","1625","1627","1629","1630","1665","1705","1744","1760","1762","1785","1825","1864","1866","1920","1923","1945","1946","1948","1950","1951","1956","1958","1989","1990","1992","1996","2009","2020","2060","2061","2068","2069","2196","2197","2198","2199","2200","2228","2248","2250","2266","2268","2269","2277","2280","2286","2288","2289","2290","2291","2292","2295","2315","2335","2340","2341","2344","2354","2355","2357","2359","2364","2365","2371","24499","24796","2484","2485","2486","2487","2489","2495","2497","2500","2500B","2504","2508","2510","2512","2516","2520","2520B","2524","2528","2532","2536","2540","2540B","2544","2548","2604","2605","2606","2620","2655","2661","2665","2700","2701","2705","2710","2730","2785","2820","2850","2851","2852","2870","2885","2921","2945","3025","3033","3040","3047","3055","3056","3057","3065","3090","3100","3101","3115","3134","3135","3220","3225","3240","3260","3265","3266","3267","3270","3295","3296","3299","3301","3305","3307","3310","3314","3315","3350","3364","3380","34499","3450","34796","3481","3482","3487","3488","3489","3585","3586","3600","3610","3620","3621","3622","3623","3625","3626","3724","3726","3727","3759","3760","3810","3811","3840","3841","3848","3849","3850","3854","3855","3865","3887","3888","3955","3970","3974","3980","3982","3984","3986","3992","3995","4001","4002","4020","4044","4045","4046","4050","4085","4087","4088","4089","4090","4094","4096","4098","4101","4102","4103","4104","4105","4108","4111","4115","4116","4118","4119","4120","4125","4130","4131","4132","4133","4135","4137","4158","4159","4160","4175","4185","4187","4189","4191","4192","4193","4194","4195","4260","4261","4340","4380","4388","4390","4400","4401","4402","4420","4422","4424","4429","4463","4464","4465","4467","4470","4473","4475","4476","4478","4480","4488","4489","4490","4491","4492","4493","4494","4495","4496","4497","4498","4499","4500","4501","4502","4503","4507","4508","4510","4512","4561","4563","4581","4582","4620","4621","4622","4633","4634","4635","4636","4639","4640","4641","4642","4647","4648","4649","4653","4660","4670","4672","4705","4711","4740","4741","4742","4743","4780","4781","4785","4787","4788","4790","4791","4792","4793","4794","4795","4797","4798","4799","4801","4803","4804","4815","4850","4875","4877","4880","4915","4920","4922","4925","4940","4941","4942","4953","4955","4960","4970","4980","4990","5020","5060","5100","5101","5102","5103","5104","5108","5114","5115","5118","5135","5136","5137","5145","5175","5180","5200","5202","5205","5206","5345","5380","5382","5540","5541","5542","5559","5560","5561","5620","5621","5635","5660","5744","5830","5831","5845","5850","5860","5860S","5861","5865","5866","5868","5870","5871","5875","5876","5877","5890","5891","5892","5940","5944","5949","5991","6005","6009","6010","6014","6015","6016","6018","6033","6044","6048","6049","6050","6052","6053","6054","6055","6056","6057","6190","6191","6195","6198","6200","6203","6205","6209","6218","6219","6220","6222","6223","6224","6225","6226","6227","6228","6229","6230","6265","6315","6316","6329","6330","6344","6395","6404","6405","6464","6466","6467","6470","6471","6494","6495","6497","6499","6501","6502","6503","6510","6525","6526","6592","6593","6598","6599","6612","6613","6620","6660","6685","6720","6721","6722","6745","6780","6781","6800","6803","6824","6828","6845","6850","6862","6863","6910","6946","6947","6951","6955","6985","6986","7020","7135","7137","7140","7142","7143","7144","7161","7162","7163","7164","7166","7181","7182","7195","7196","7225","7226","7235","7236","7262","7270","7271","7272","7291","7305","7306","7310","7311","7344","7348","7350","7383","7391","7399","7409","7410","7420","7422","7424","7435","7436","7437","7439","7441","7443","7465","7466","7500","7505","7545","7580","7600","7601","7603","7605","7630","7645","7695","7709","7710","7713","7715","7722","7723","7725","7726","7727","7729","7730","7732","7733","7755","7757","7758","7761","7763","7764","7765","7768","7769","7844","7869","7871","7915","7920","7921","7925","7939","7940","7941","7943","7946","7960","7961","7970","7974","7975","7976","7977","7980","7992","7996","7997","8011","8020","8031","8033","8035","8037","8042","8044","8047","8048","8082","8087","8089","8105","8122","8131","8133","8165","8166","8205","8206","8215","8220","8240","8241","8242","8243","8244","8290","8291","8329","8330","8350","8353","8355","8357","8363","8375","8376","8377","8378","8380","8381","8388","8404","8408","8413","8414","8422","8423","8438","8445","8466","8467","8468","8484","8520","8522","8527","8528","8539","8540","8541","8542","8544","8560","8562","8580","8605","8610","8615","8635","8680","8681","8720","8765","8766","8805","8807","8810","8811","8815","8824","8840","8842","8846","8848","8880","8883","8925","8965","8966","9040","9044","9048","9060","9101","9121","9135","9145","9205","9230","9244","9289","9299","9320","9330","9331","9332","9333","9335","9355","9356","9361","9401","9403","9420","9455","9489","9505","9507","9510","9511","9515","9525","9544","9555","9574","9576","9580","9622","9624","9626","9630","9655","9663","9670","9705","9706","9709","9712","9713","9715","9716","9718","9719","9720","9736","9740","9741","9744","9745","9800","9820","9835","9840","9850","9928","9929","9960","9962","9970","9974","9978","9980","9983","9984")

df = pd.DataFrame(columns=['Product', 'CAS Number', 'DOT Hazard Class', 'SDS URL'])

df['Product'] = prods

df = df.set_index('Product')

def scraper(product):
    base_url = 'https://<elided>'
    prod_url = base_url + '/product/' + product + '/'

    cas = dot = 0 
    cas_val = dot_val = ''

    fetched_page = requests.get(prod_url).content

    soup = BeautifulSoup(fetched_page, "html.parser")
 
    for ul in soup.findAll('ul'):
        ## the parameters we're interested in are in the "detail-list" class
        if ul.attrs and 'detail-list' in ul.attrs['class']:
            #print('get_text:')
            #print(ul.get_text(' ', strip=True))
            #print()

            for i in (ul.stripped_strings):
                if 'CAS Number' in i:
                    cas = 1
                elif 'DOT Hazard Class' in i:
                    dot = 1
                elif cas == 1:
                    df.at[product, 'CAS Number'] = i
                    cas = 0
                elif dot == 1:
                    df.at[product, 'DOT Hazard Class'] = i
                    dot = 0

    ## sds link is in a button at bottom of page
    for btn in soup.findAll(class_='btn'):
        ## sample attrs:
        ## {'class': ['btn'], 'href': '/docs/SDS/10170-100615.pdf', 'target': '_blank'}
        if 'href' in btn.attrs:
            sds_uri = btn.get('href')
            sds_url = base_url + sds_uri
            df.at[product, 'SDS URL'] = sds_url

for i in prods:
    scraper(i)
    print(df.loc[i])

df
